<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OT Risk Severity Calculator v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            scroll-behavior: auto; /* Prevent auto-scrolling */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .version {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .content {
            padding: 30px;
        }

        .asset-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .asset-info h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }

        .input-group input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .dimension {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            transition: all 0.3s;
        }

        .dimension:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .dimension-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dimension-title h3 {
            color: #333;
            font-size: 1.3em;
        }

        .weight-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .dimension-score {
            background: #f8f9fa;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.1em;
            color: #667eea;
        }

        /* Grid layout for options */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }

        .option-box {
            position: relative;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-box:hover {
            background: #e8f4f8;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.2);
        }

        .option-box input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .option-box input[type="radio"]:checked + .option-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .option-box input[type="radio"]:checked ~ .option-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .option-content {
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .option-label {
            font-weight: 600;
            font-size: 1em;
        }

        .option-value {
            font-size: 0.85em;
            opacity: 0.8;
        }

        .option-desc {
            font-size: 0.75em;
            opacity: 0.7;
            margin-top: 5px;
        }

        .safety-alert {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .safety-alert.active {
            display: block;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .safety-alert h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .results {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
        }

        .results h2 {
            margin-bottom: 20px;
            font-size: 2em;
        }

        .score-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .score-card {
            background: rgba(255,255,255,0.25);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .score-card h4 {
            font-size: 0.9em;
            margin-bottom: 10px;
            opacity: 1;
            color: #ffffff;
            font-weight: 600;
        }

        .score-card .score {
            font-size: 2.5em;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .score-card small {
            color: #ffffff;
            opacity: 0.9;
        }

        .final-score {
            background: rgba(255,255,255,0.25);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .final-score h3 {
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .final-score .score {
            font-size: 4em;
            font-weight: 700;
            margin: 20px 0;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .rating {
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 1.5em;
            font-weight: 700;
            display: inline-block;
            margin: 15px 0;
            border: 3px solid rgba(255,255,255,0.3);
            color: #ffffff;
            background: rgba(0,0,0,0.2);
        }

        .rating-critical { background: #dc3545; color: white; border-color: #c82333; }
        .rating-high { background: #fd7e14; color: white; border-color: #e8690b; }
        .rating-medium { background: #ffc107; color: #333; border-color: #d39e00; }
        .rating-low { background: #28a745; color: white; border-color: #218838; }
        .rating-info { background: #17a2b8; color: white; border-color: #138496; }

        .recommendations {
            background: rgba(255,255,255,0.25);
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .recommendations h4 {
            margin-bottom: 15px;
            font-size: 1.3em;
            color: #ffffff;
        }

        .recommendations ul {
            list-style-position: inside;
            line-height: 1.8;
            color: #ffffff;
        }

        .recommendations p {
            color: #ffffff;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: white;
            color: #667eea;
        }

        .btn-primary:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #e0e0e0;
        }

        .url-info {
            background: #e8f4f8;
            border: 2px solid #17a2b8;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 0.9em;
            word-break: break-all;
        }

        @media print {
            body {
                background: white;
            }
            .actions, .btn {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }

            .score-display {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è OT Risk Severity Calculator</h1>
            <p>Comprehensive Risk Assessment for Operational Technology Environments</p>
        </div>

        <div class="content">
            <!-- Asset Information -->
            <div class="asset-info">
                <h2>üìã Asset Information</h2>
                <div class="input-grid">
                    <div class="input-group">
                        <label for="assetName">Asset Name/ID *</label>
                        <input type="text" id="assetName" placeholder="e.g., PLC-01-REACTOR">
                    </div>
                    <div class="input-group">
                        <label for="assetType">Asset Type *</label>
                        <input type="text" id="assetType" placeholder="e.g., PLC, SCADA, HMI">
                    </div>
                    <div class="input-group">
                        <label for="vulnName">Vulnerability Name</label>
                        <input type="text" id="vulnName" placeholder="e.g., Unauthorized Access Vulnerability">
                    </div>
                    <div class="input-group">
                        <label for="cveId">CVE ID</label>
                        <input type="text" id="cveId" placeholder="e.g., CVE-2024-12345">
                    </div>
                    <div class="input-group">
                        <label for="assessmentDate">Assessment Date</label>
                        <input type="date" id="assessmentDate">
                    </div>
                </div>
            </div>

            <!-- Safety Alert -->
            <div class="safety-alert" id="safetyAlert">
                <h3>‚ö†Ô∏è CRITICAL SAFETY IMPACT DETECTED</h3>
                <p>This vulnerability has CATASTROPHIC safety implications. Minimum risk score has been set to 8.0 (HIGH/CRITICAL). Immediate attention and emergency response procedures may be required.</p>
            </div>

            <!-- Dimension 1: Safety & Consequence Impact -->
            <div class="dimension">
                <div class="dimension-header">
                    <div class="dimension-title">
                        <h3>üö® 1. Safety & Consequence Impact</h3>
                        <span class="weight-badge">Weight: 30%</span>
                    </div>
                    <div class="dimension-score" id="safetyScore">0.0</div>
                </div>
                <div class="options-grid" id="safetyOptions">
                    <label class="option-box">
                        <input type="radio" name="safety" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">None</div>
                            <div class="option-value">Score: 0</div>
                            <div class="option-desc">No safety impact</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="safety" value="2.5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Minor</div>
                            <div class="option-value">Score: 2.5</div>
                            <div class="option-desc">Minimal safety concern</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="safety" value="5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Moderate</div>
                            <div class="option-value">Score: 5</div>
                            <div class="option-desc">Equipment damage possible</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="safety" value="7.5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Significant</div>
                            <div class="option-value">Score: 7.5</div>
                            <div class="option-desc">Injury or environmental damage</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="safety" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Catastrophic</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">Loss of life or major disaster</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Dimension 2: Technical Vulnerability (CVSS-based) -->
            <div class="dimension">
                <div class="dimension-header">
                    <div class="dimension-title">
                        <h3>üîß 2. Technical Vulnerability Severity</h3>
                        <span class="weight-badge">Weight: 20%</span>
                    </div>
                    <div class="dimension-score" id="technicalScore">0.0</div>
                </div>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="technical" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">None</div>
                            <div class="option-value">CVSS: 0.0</div>
                            <div class="option-desc">No vulnerability</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="technical" value="3" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Low</div>
                            <div class="option-value">CVSS: 0.1-3.9</div>
                            <div class="option-desc">Local access, no privileges</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="technical" value="5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Medium</div>
                            <div class="option-value">CVSS: 4.0-6.9</div>
                            <div class="option-desc">Network access, user interaction</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="technical" value="7.5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">High</div>
                            <div class="option-value">CVSS: 7.0-8.9</div>
                            <div class="option-desc">Network exploitable</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="technical" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Critical</div>
                            <div class="option-value">CVSS: 9.0-10.0</div>
                            <div class="option-desc">Unauthenticated remote code execution</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Dimension 3: Asset Criticality -->
            <div class="dimension">
                <div class="dimension-header">
                    <div class="dimension-title">
                        <h3>üè≠ 3. Asset Criticality & Role</h3>
                        <span class="weight-badge">Weight: 20%</span>
                    </div>
                    <div class="dimension-score" id="assetScore">0.0</div>
                </div>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="asset" value="2" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Support/Admin</div>
                            <div class="option-value">Score: 2</div>
                            <div class="option-desc">Engineering workstation, dev system</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="asset" value="5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Monitoring</div>
                            <div class="option-value">Score: 5</div>
                            <div class="option-desc">HMI, historian, data collection</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="asset" value="7.5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Production Control</div>
                            <div class="option-value">Score: 7.5</div>
                            <div class="option-desc">Production PLC, SCADA master</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="asset" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Safety System</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">SIS, ESD, fire & gas, safety PLC</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Dimension 4: AIC Impact (Availability, Integrity, Confidentiality) -->
            <div class="dimension">
                <div class="dimension-header">
                    <div class="dimension-title">
                        <h3>üîê 4. AIC Impact (Availability, Integrity, Confidentiality)</h3>
                        <span class="weight-badge">Weight: 15%</span>
                    </div>
                    <div class="dimension-score" id="aicScore">0.0</div>
                </div>
                
                <h4 style="margin: 15px 0 10px 0; color: #667eea;">Availability Impact:</h4>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="availability" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">None</div>
                            <div class="option-value">Score: 0</div>
                            <div class="option-desc">No availability impact</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="availability" value="3.33" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Low</div>
                            <div class="option-value">Score: 3.33</div>
                            <div class="option-desc">Minor performance degradation</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="availability" value="6.67" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Moderate</div>
                            <div class="option-value">Score: 6.67</div>
                            <div class="option-desc">Significant downtime or disruption</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="availability" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">High</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">Total loss of availability/shutdown</div>
                        </div>
                    </label>
                </div>

                <h4 style="margin: 15px 0 10px 0; color: #667eea;">Integrity Impact:</h4>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="integrity" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">None</div>
                            <div class="option-value">Score: 0</div>
                            <div class="option-desc">No integrity impact</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="integrity" value="3.33" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Low</div>
                            <div class="option-value">Score: 3.33</div>
                            <div class="option-desc">Limited data/control modification</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="integrity" value="6.67" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Moderate</div>
                            <div class="option-value">Score: 6.67</div>
                            <div class="option-desc">Process control manipulation</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="integrity" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">High</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">Full system compromise</div>
                        </div>
                    </label>
                </div>

                <h4 style="margin: 15px 0 10px 0; color: #667eea;">Confidentiality Impact:</h4>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="confidentiality" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">None</div>
                            <div class="option-value">Score: 0</div>
                            <div class="option-desc">No confidentiality impact</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="confidentiality" value="3.33" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Low</div>
                            <div class="option-value">Score: 3.33</div>
                            <div class="option-desc">Limited data exposure</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="confidentiality" value="6.67" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Moderate</div>
                            <div class="option-value">Score: 6.67</div>
                            <div class="option-desc">Sensitive operational data leaked</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="confidentiality" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">High</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">Complete data breach/IP theft</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Dimension 5: Environmental Context & Controls -->
            <div class="dimension">
                <div class="dimension-header">
                    <div class="dimension-title">
                        <h3>üõ°Ô∏è 5. Environmental Context & Compensating Controls</h3>
                        <span class="weight-badge">Weight: 10%</span>
                    </div>
                    <div class="dimension-score" id="environmentScore">0.0</div>
                </div>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="environment" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">No Protection</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">Internet-facing, no segmentation</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="environment" value="7.5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Basic Protection</div>
                            <div class="option-value">Score: 7.5</div>
                            <div class="option-desc">Minimal firewall, flat network</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="environment" value="5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Moderate Protection</div>
                            <div class="option-value">Score: 5</div>
                            <div class="option-desc">Network segmentation, basic monitoring</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="environment" value="2.5" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Good Protection</div>
                            <div class="option-value">Score: 2.5</div>
                            <div class="option-desc">Defense in depth, IDS/IPS, monitoring</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="environment" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Strong Protection</div>
                            <div class="option-value">Score: 0</div>
                            <div class="option-desc">Air-gapped, physical security</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Dimension 6: Threat Intelligence & Exploitability -->
            <div class="dimension">
                <div class="dimension-header">
                    <div class="dimension-title">
                        <h3>üéØ 6. Threat Intelligence & Exploitability</h3>
                        <span class="weight-badge">Weight: 5%</span>
                    </div>
                    <div class="dimension-score" id="threatScore">0.0</div>
                </div>
                <div class="options-grid">
                    <label class="option-box">
                        <input type="radio" name="threat" value="0" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Theoretical</div>
                            <div class="option-value">Score: 0</div>
                            <div class="option-desc">No known exploit, theoretical only</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="threat" value="3.33" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">PoC Exists</div>
                            <div class="option-value">Score: 3.33</div>
                            <div class="option-desc">Proof of concept published</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="threat" value="6.67" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Public Exploit</div>
                            <div class="option-value">Score: 6.67</div>
                            <div class="option-desc">Working exploit publicly available</div>
                        </div>
                    </label>
                    <label class="option-box">
                        <input type="radio" name="threat" value="10" onclick="event.stopPropagation();">
                        <div class="option-content">
                            <div class="option-label">Active Exploitation</div>
                            <div class="option-value">Score: 10</div>
                            <div class="option-desc">Active exploitation in the wild/CISA KEV</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results">
                <h2>üìä OT Risk Seveirty Assessment Results</h2>
                
                <div class="score-display">
                    <div class="score-card">
                        <h4>Safety & Consequence</h4>
                        <div class="score" id="resultSafety">0.0</div>
                        <small>(30% weight)</small>
                    </div>
                    <div class="score-card">
                        <h4>Technical Vulnerability</h4>
                        <div class="score" id="resultTechnical">0.0</div>
                        <small>(20% weight)</small>
                    </div>
                    <div class="score-card">
                        <h4>Asset Criticality</h4>
                        <div class="score" id="resultAsset">0.0</div>
                        <small>(20% weight)</small>
                    </div>
                    <div class="score-card">
                        <h4>AIC Impact</h4>
                        <div class="score" id="resultAIC">0.0</div>
                        <small>(15% weight)</small>
                    </div>
                    <div class="score-card">
                        <h4>Environment & Controls</h4>
                        <div class="score" id="resultEnvironment">0.0</div>
                        <small>(10% weight)</small>
                    </div>
                    <div class="score-card">
                        <h4>Threat Intelligence</h4>
                        <div class="score" id="resultThreat">0.0</div>
                        <small>(5% weight)</small>
                    </div>
                </div>

                <div class="final-score">
                    <h3>Final Score</h3>
                    <div class="score" id="finalScore" style="color: #ffffff;">0.0</div>
                    <div class="rating" id="riskRating">NOT ASSESSED</div>
                    
                    <div class="recommendations">
                        <h4>üéØ Recommended Actions:</h4>
                        <div id="recommendations">
                            <p>Complete the assessment above to receive tailored recommendations.</p>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button class="btn btn-primary" onclick="printReport()">üñ®Ô∏è Print Report</button>
                    <button class="btn btn-primary" onclick="exportData()">üíæ Export Data (JSON)</button>
                    <button class="btn btn-primary" onclick="copyURL()">üîó Copy Shareable URL</button>
                    <button class="btn btn-secondary" onclick="resetCalculator()">üîÑ Reset Calculator</button>
                </div>

                <div class="url-info" id="urlDisplay" style="display: none;">
                    <strong>Shareable URL:</strong><br>
                    <span id="shareableURL"></span>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><strong>OT Risk Severity Calculator</strong></p>
            <p>Designed for comprehensive OT/ICS vulnerability assessment and risk prioritization</p>
        </div>
    </div>

    <script>
        // Weight configuration
        const WEIGHTS = {
            safety: 0.30,
            technical: 0.20,
            asset: 0.20,
            aic: 0.15,
            environment: 0.10,
            threat: 0.05
        };

        // Initialize date to today
        document.getElementById('assessmentDate').valueAsDate = new Date();

        // Parse URL parameters on page load
        window.addEventListener('DOMContentLoaded', function() {
            parseURLParameters();
        });

        function parseURLParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Asset info
            if (urlParams.has('asset')) document.getElementById('assetName').value = urlParams.get('asset');
            if (urlParams.has('type')) document.getElementById('assetType').value = urlParams.get('type');
            if (urlParams.has('vuln')) document.getElementById('vulnName').value = urlParams.get('vuln');
            if (urlParams.has('cve')) document.getElementById('cveId').value = urlParams.get('cve');
            if (urlParams.has('date')) document.getElementById('assessmentDate').value = urlParams.get('date');
            
            // Scores
            const dimensions = ['safety', 'technical', 'asset', 'availability', 'integrity', 'confidentiality', 'environment', 'threat'];
            dimensions.forEach(dim => {
                if (urlParams.has(dim)) {
                    const value = urlParams.get(dim);
                    const radio = document.querySelector(`input[name="${dim}"][value="${value}"]`);
                    if (radio) {
                        radio.checked = true;
                    }
                }
            });
            
            // Calculate if any parameters were loaded
            if (urlParams.toString()) {
                calculateScore();
            }
        }

        function generateShareableURL() {
            const baseURL = window.location.origin + window.location.pathname;
            const params = new URLSearchParams();
            
            // Asset info
            const assetName = document.getElementById('assetName').value;
            const assetType = document.getElementById('assetType').value;
            const vulnName = document.getElementById('vulnName').value;
            const cveId = document.getElementById('cveId').value;
            const assessmentDate = document.getElementById('assessmentDate').value;
            
            if (assetName) params.append('asset', assetName);
            if (assetType) params.append('type', assetType);
            if (vulnName) params.append('vuln', vulnName);
            if (cveId) params.append('cve', cveId);
            if (assessmentDate) params.append('date', assessmentDate);
            
            // Dimension scores
            const dimensions = ['safety', 'technical', 'asset', 'availability', 'integrity', 'confidentiality', 'environment', 'threat'];
            dimensions.forEach(dim => {
                const selected = document.querySelector(`input[name="${dim}"]:checked`);
                if (selected) {
                    params.append(dim, selected.value);
                }
            });
            
            return params.toString() ? `${baseURL}?${params.toString()}` : baseURL;
        }

        function copyURL() {
            const url = generateShareableURL();
            navigator.clipboard.writeText(url).then(() => {
                document.getElementById('shareableURL').textContent = url;
                document.getElementById('urlDisplay').style.display = 'block';
                alert('‚úÖ Shareable URL copied to clipboard!');
            });
        }

        // Add event listeners to all radio buttons
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function(e) {
                e.preventDefault();
                calculateScore();
            });
        });

        function calculateScore() {
            // Get selected values
            const safety = parseFloat(document.querySelector('input[name="safety"]:checked')?.value || 0);
            const technical = parseFloat(document.querySelector('input[name="technical"]:checked')?.value || 0);
            const asset = parseFloat(document.querySelector('input[name="asset"]:checked')?.value || 0);
            const availability = parseFloat(document.querySelector('input[name="availability"]:checked')?.value || 0);
            const integrity = parseFloat(document.querySelector('input[name="integrity"]:checked')?.value || 0);
            const confidentiality = parseFloat(document.querySelector('input[name="confidentiality"]:checked')?.value || 0);
            const environment = parseFloat(document.querySelector('input[name="environment"]:checked')?.value || 0);
            const threat = parseFloat(document.querySelector('input[name="threat"]:checked')?.value || 0);

            // Calculate AIC average
            const aicAverage = (availability + integrity + confidentiality) / 3;

            // Update dimension scores
            document.getElementById('safetyScore').textContent = safety.toFixed(1);
            document.getElementById('technicalScore').textContent = technical.toFixed(1);
            document.getElementById('assetScore').textContent = asset.toFixed(1);
            document.getElementById('aicScore').textContent = aicAverage.toFixed(1);
            document.getElementById('environmentScore').textContent = environment.toFixed(1);
            document.getElementById('threatScore').textContent = threat.toFixed(1);

            // Calculate weighted score
            let finalScore = (
                (safety * WEIGHTS.safety) +
                (technical * WEIGHTS.technical) +
                (asset * WEIGHTS.asset) +
                (aicAverage * WEIGHTS.aic) +
                (environment * WEIGHTS.environment) +
                (threat * WEIGHTS.threat)
            );

            // Safety override - if catastrophic safety impact, minimum score is 8.0
            if (safety === 10) {
                document.getElementById('safetyAlert').classList.add('active');
                if (finalScore < 8.0) {
                    finalScore = 8.0;
                }
            } else {
                document.getElementById('safetyAlert').classList.remove('active');
            }

            // Update results
            document.getElementById('resultSafety').textContent = safety.toFixed(1);
            document.getElementById('resultTechnical').textContent = technical.toFixed(1);
            document.getElementById('resultAsset').textContent = asset.toFixed(1);
            document.getElementById('resultAIC').textContent = aicAverage.toFixed(1);
            document.getElementById('resultEnvironment').textContent = environment.toFixed(1);
            document.getElementById('resultThreat').textContent = threat.toFixed(1);
            document.getElementById('finalScore').textContent = finalScore.toFixed(1);

            // Determine risk rating
            let rating, ratingClass, priority, timeline, actions;
            
            if (finalScore >= 9.0) {
                rating = 'CRITICAL';
                ratingClass = 'rating-critical';
                priority = 'NOW';
                timeline = '0-24 hours';
                actions = `
                    <ul>
                        <li><strong>Immediate Action Required:</strong> Initiate emergency response procedures</li>
                        <li>Convene incident response team within 2 hours</li>
                        <li>Assess operational impact and implement temporary mitigations</li>
                        <li>Develop remediation plan with C-level approval</li>
                        <li>Consider emergency maintenance window if system shutdown required</li>
                        <li>Document all actions and maintain audit trail</li>
                    </ul>
                `;
            } else if (finalScore >= 7.5) {
                rating = 'HIGH';
                ratingClass = 'rating-high';
                priority = 'NEXT';
                timeline = '1-7 days';
                actions = `
                    <ul>
                        <li><strong>Urgent Priority:</strong> Schedule remediation within next maintenance window</li>
                        <li>Assess and implement additional monitoring/detection capabilities</li>
                        <li>Review and strengthen compensating controls</li>
                        <li>Coordinate with operations for planned remediation</li>
                        <li>Prepare rollback procedures before applying patches</li>
                    </ul>
                `;
            } else if (finalScore >= 5.5) {
                rating = 'MEDIUM';
                ratingClass = 'rating-medium';
                priority = 'NEXT';
                timeline = '1-30 days';
                actions = `
                    <ul>
                        <li><strong>Standard Priority:</strong> Include in quarterly maintenance cycle</li>
                        <li>Verify existing compensating controls are effective</li>
                        <li>Plan remediation during scheduled maintenance window</li>
                        <li>Test patches in development environment first</li>
                        <li>Document risk acceptance if remediation is delayed</li>
                    </ul>
                `;
            } else if (finalScore >= 3.0) {
                rating = 'LOW';
                ratingClass = 'rating-low';
                priority = 'PLANNED';
                timeline = '30-90 days';
                actions = `
                    <ul>
                        <li><strong>Planned Remediation:</strong> Address during annual maintenance</li>
                        <li>Include in routine patch management cycle</li>
                        <li>Monitor for changes in threat landscape or exploitability</li>
                        <li>Review as part of regular security assessments</li>
                    </ul>
                `;
            } else {
                rating = 'INFORMATIONAL';
                ratingClass = 'rating-info';
                priority = 'NEVER';
                timeline = 'Informational only';
                actions = `
                    <ul>
                        <li><strong>No Action Required:</strong> Document for awareness only</li>
                        <li>Monitor for changes in circumstances that could elevate risk</li>
                        <li>Include in annual risk review but no immediate action needed</li>
                    </ul>
                `;
            }

            document.getElementById('riskRating').textContent = rating;
            document.getElementById('riskRating').className = `rating ${ratingClass}`;
            document.getElementById('recommendations').innerHTML = `
                <p><strong>Priority:</strong> ${priority} | <strong>Timeline:</strong> ${timeline}</p>
                ${actions}
            `;
        }

        function resetCalculator() {
            if (confirm('Are you sure you want to reset the calculator? All data will be lost.')) {
                // Clear all form inputs
                document.querySelectorAll('input[type="text"], input[type="date"]').forEach(input => {
                    input.value = '';
                });
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.checked = false;
                });
                
                // Reset date to today
                document.getElementById('assessmentDate').valueAsDate = new Date();
                
                // Reset all scores
                document.getElementById('safetyScore').textContent = '0.0';
                document.getElementById('technicalScore').textContent = '0.0';
                document.getElementById('assetScore').textContent = '0.0';
                document.getElementById('aicScore').textContent = '0.0';
                document.getElementById('environmentScore').textContent = '0.0';
                document.getElementById('threatScore').textContent = '0.0';
                document.getElementById('finalScore').textContent = '0.0';
                document.getElementById('riskRating').textContent = 'NOT ASSESSED';
                document.getElementById('riskRating').className = 'rating';
                document.getElementById('recommendations').innerHTML = '<p>Complete the assessment above to receive tailored recommendations.</p>';
                document.getElementById('safetyAlert').classList.remove('active');
                document.getElementById('urlDisplay').style.display = 'none';
                
                // Clear URL parameters
                window.history.pushState({}, '', window.location.pathname);
            }
        }

        function printReport() {
            window.print();
        }

        function exportData() {
            const data = {
                metadata: {
                    exportDate: new Date().toISOString(),
                    calculator: 'OT Risk Severity Calculator',
                    assessmentDate: document.getElementById('assessmentDate').value
                },
                asset: {
                    name: document.getElementById('assetName').value,
                    type: document.getElementById('assetType').value,
                    vulnerabilityName: document.getElementById('vulnName').value,
                    cveId: document.getElementById('cveId').value
                },
                dimensions: {
                    safety: parseFloat(document.querySelector('input[name="safety"]:checked')?.value || 0),
                    technical: parseFloat(document.querySelector('input[name="technical"]:checked')?.value || 0),
                    asset: parseFloat(document.querySelector('input[name="asset"]:checked')?.value || 0),
                    aic: {
                        availability: parseFloat(document.querySelector('input[name="availability"]:checked')?.value || 0),
                        integrity: parseFloat(document.querySelector('input[name="integrity"]:checked')?.value || 0),
                        confidentiality: parseFloat(document.querySelector('input[name="confidentiality"]:checked')?.value || 0)
                    },
                    environment: parseFloat(document.querySelector('input[name="environment"]:checked')?.value || 0),
                    threat: parseFloat(document.querySelector('input[name="threat"]:checked')?.value || 0)
                },
                results: {
                    finalScore: parseFloat(document.getElementById('finalScore').textContent),
                    rating: document.getElementById('riskRating').textContent
                }
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `OT_Risk_Assessment_${data.asset.name || 'Unknown'}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
